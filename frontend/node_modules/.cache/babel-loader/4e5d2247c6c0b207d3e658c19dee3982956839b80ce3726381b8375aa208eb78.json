{"ast":null,"code":"import _objectSpread from\"/home/zobair-qauomi/todo_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * Notification utilities for browser notifications and reminders\n */// Check if browser notifications are supported\nexport const areNotificationsSupported=()=>{return'Notification'in window;};// Check if notifications are permitted\nexport const areNotificationsPermitted=()=>{return areNotificationsSupported()&&Notification.permission==='granted';};// Request notification permission\nexport const requestNotificationPermission=async()=>{if(!areNotificationsSupported()){console.warn('Browser notifications are not supported');return false;}if(Notification.permission==='granted'){return true;}if(Notification.permission!=='denied'){const permission=await Notification.requestPermission();return permission==='granted';}return false;};// Show a browser notification\nexport const showNotification=(title,options)=>{if(!areNotificationsPermitted()){console.warn('Notifications not permitted');return null;}try{const notification=new Notification(title,_objectSpread({icon:'/favicon.ico',badge:'/favicon.ico'},options));notification.onclick=()=>{window.focus();notification.close();};return notification;}catch(error){console.error('Failed to show notification:',error);return null;}};// Show task due notification\nexport const showTaskDueNotification=(taskText,dueDate,minutesUntil)=>{let timeMessage='';if(minutesUntil<=0){timeMessage='is due now!';}else if(minutesUntil<60){timeMessage=\"is due in \".concat(minutesUntil,\" minute\").concat(minutesUntil>1?'s':'');}else{const hours=Math.floor(minutesUntil/60);timeMessage=\"is due in \".concat(hours,\" hour\").concat(hours>1?'s':'');}return showNotification(\"Task Reminder: \".concat(taskText),{body:\"Your task \\\"\".concat(taskText,\"\\\" \").concat(timeMessage),tag:\"task-due-\".concat(dueDate),requireInteraction:true});};// Schedule notifications for a task\nexport const scheduleNotifications=function(taskId,taskText,dueDate){let timings=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[15,60,1440];const due=new Date(dueDate);const now=new Date();const notifications=[];timings.forEach(timing=>{const notifyAt=new Date(due.getTime()-timing*60*1000);// Only schedule if the notification time is in the future\nif(notifyAt>now){notifications.push({taskId,taskText,dueDate,notifyAt:notifyAt.getTime(),timing});}});return notifications;};// Store scheduled notifications in localStorage\nexport const storeScheduledNotifications=notifications=>{localStorage.setItem('scheduledNotifications',JSON.stringify(notifications));};// Get scheduled notifications from localStorage\nexport const getScheduledNotifications=()=>{const stored=localStorage.getItem('scheduledNotifications');if(stored){try{return JSON.parse(stored);}catch(error){console.error('Failed to parse scheduled notifications:',error);return[];}}return[];};// Check and trigger due notifications\nexport const checkNotifications=()=>{const notifications=getScheduledNotifications();const now=Date.now();const triggered=[];notifications.forEach(notification=>{// Check if it's time to trigger (within 1 minute window)\nif(Math.abs(now-notification.notifyAt)<60000){showTaskDueNotification(notification.taskText,notification.dueDate,notification.timing);triggered.push(notification.notifyAt);}});// Remove triggered notifications\nif(triggered.length>0){const remaining=notifications.filter(n=>!triggered.includes(n.notifyAt));storeScheduledNotifications(remaining);}};// Clear all scheduled notifications\nexport const clearScheduledNotifications=()=>{localStorage.removeItem('scheduledNotifications');};// Clear notifications for a specific task\nexport const clearTaskNotifications=taskId=>{const notifications=getScheduledNotifications();const remaining=notifications.filter(n=>n.taskId!==taskId);storeScheduledNotifications(remaining);};// Start notification checker (call once on app load)\nlet notificationInterval=null;export const startNotificationChecker=()=>{if(notificationInterval){clearInterval(notificationInterval);}// Check every minute\nnotificationInterval=setInterval(checkNotifications,60000);// Also check immediately\ncheckNotifications();};export const stopNotificationChecker=()=>{if(notificationInterval){clearInterval(notificationInterval);notificationInterval=null;}};","map":{"version":3,"names":["areNotificationsSupported","window","areNotificationsPermitted","Notification","permission","requestNotificationPermission","console","warn","requestPermission","showNotification","title","options","notification","_objectSpread","icon","badge","onclick","focus","close","error","showTaskDueNotification","taskText","dueDate","minutesUntil","timeMessage","concat","hours","Math","floor","body","tag","requireInteraction","scheduleNotifications","taskId","timings","arguments","length","undefined","due","Date","now","notifications","forEach","timing","notifyAt","getTime","push","storeScheduledNotifications","localStorage","setItem","JSON","stringify","getScheduledNotifications","stored","getItem","parse","checkNotifications","triggered","abs","remaining","filter","n","includes","clearScheduledNotifications","removeItem","clearTaskNotifications","notificationInterval","startNotificationChecker","clearInterval","setInterval","stopNotificationChecker"],"sources":["/home/zobair-qauomi/todo_app/frontend/src/utils/notifications.ts"],"sourcesContent":["/**\n * Notification utilities for browser notifications and reminders\n */\n\nexport interface NotificationSettings {\n  enabled: boolean;\n  timing: number[]; // Minutes before due date\n  type: 'browser' | 'in-app' | 'both';\n}\n\nexport interface ScheduledNotification {\n  taskId: string;\n  taskText: string;\n  dueDate: string;\n  notifyAt: number; // timestamp\n  timing: number; // minutes before\n}\n\n// Check if browser notifications are supported\nexport const areNotificationsSupported = (): boolean => {\n  return 'Notification' in window;\n};\n\n// Check if notifications are permitted\nexport const areNotificationsPermitted = (): boolean => {\n  return areNotificationsSupported() && Notification.permission === 'granted';\n};\n\n// Request notification permission\nexport const requestNotificationPermission = async (): Promise<boolean> => {\n  if (!areNotificationsSupported()) {\n    console.warn('Browser notifications are not supported');\n    return false;\n  }\n\n  if (Notification.permission === 'granted') {\n    return true;\n  }\n\n  if (Notification.permission !== 'denied') {\n    const permission = await Notification.requestPermission();\n    return permission === 'granted';\n  }\n\n  return false;\n};\n\n// Show a browser notification\nexport const showNotification = (\n  title: string,\n  options?: NotificationOptions\n): Notification | null => {\n  if (!areNotificationsPermitted()) {\n    console.warn('Notifications not permitted');\n    return null;\n  }\n\n  try {\n    const notification = new Notification(title, {\n      icon: '/favicon.ico',\n      badge: '/favicon.ico',\n      ...options,\n    });\n\n    notification.onclick = () => {\n      window.focus();\n      notification.close();\n    };\n\n    return notification;\n  } catch (error) {\n    console.error('Failed to show notification:', error);\n    return null;\n  }\n};\n\n// Show task due notification\nexport const showTaskDueNotification = (\n  taskText: string,\n  dueDate: string,\n  minutesUntil: number\n): Notification | null => {\n  let timeMessage = '';\n  if (minutesUntil <= 0) {\n    timeMessage = 'is due now!';\n  } else if (minutesUntil < 60) {\n    timeMessage = `is due in ${minutesUntil} minute${minutesUntil > 1 ? 's' : ''}`;\n  } else {\n    const hours = Math.floor(minutesUntil / 60);\n    timeMessage = `is due in ${hours} hour${hours > 1 ? 's' : ''}`;\n  }\n\n  return showNotification(`Task Reminder: ${taskText}`, {\n    body: `Your task \"${taskText}\" ${timeMessage}`,\n    tag: `task-due-${dueDate}`,\n    requireInteraction: true,\n  });\n};\n\n// Schedule notifications for a task\nexport const scheduleNotifications = (\n  taskId: string,\n  taskText: string,\n  dueDate: string,\n  timings: number[] = [15, 60, 1440] // 15min, 1hr, 24hr\n): ScheduledNotification[] => {\n  const due = new Date(dueDate);\n  const now = new Date();\n  const notifications: ScheduledNotification[] = [];\n\n  timings.forEach((timing) => {\n    const notifyAt = new Date(due.getTime() - timing * 60 * 1000);\n\n    // Only schedule if the notification time is in the future\n    if (notifyAt > now) {\n      notifications.push({\n        taskId,\n        taskText,\n        dueDate,\n        notifyAt: notifyAt.getTime(),\n        timing,\n      });\n    }\n  });\n\n  return notifications;\n};\n\n// Store scheduled notifications in localStorage\nexport const storeScheduledNotifications = (notifications: ScheduledNotification[]): void => {\n  localStorage.setItem('scheduledNotifications', JSON.stringify(notifications));\n};\n\n// Get scheduled notifications from localStorage\nexport const getScheduledNotifications = (): ScheduledNotification[] => {\n  const stored = localStorage.getItem('scheduledNotifications');\n  if (stored) {\n    try {\n      return JSON.parse(stored);\n    } catch (error) {\n      console.error('Failed to parse scheduled notifications:', error);\n      return [];\n    }\n  }\n  return [];\n};\n\n// Check and trigger due notifications\nexport const checkNotifications = (): void => {\n  const notifications = getScheduledNotifications();\n  const now = Date.now();\n  const triggered: number[] = [];\n\n  notifications.forEach((notification) => {\n    // Check if it's time to trigger (within 1 minute window)\n    if (Math.abs(now - notification.notifyAt) < 60000) {\n      showTaskDueNotification(\n        notification.taskText,\n        notification.dueDate,\n        notification.timing\n      );\n      triggered.push(notification.notifyAt);\n    }\n  });\n\n  // Remove triggered notifications\n  if (triggered.length > 0) {\n    const remaining = notifications.filter(\n      (n) => !triggered.includes(n.notifyAt)\n    );\n    storeScheduledNotifications(remaining);\n  }\n};\n\n// Clear all scheduled notifications\nexport const clearScheduledNotifications = (): void => {\n  localStorage.removeItem('scheduledNotifications');\n};\n\n// Clear notifications for a specific task\nexport const clearTaskNotifications = (taskId: string): void => {\n  const notifications = getScheduledNotifications();\n  const remaining = notifications.filter((n) => n.taskId !== taskId);\n  storeScheduledNotifications(remaining);\n};\n\n// Start notification checker (call once on app load)\nlet notificationInterval: NodeJS.Timeout | null = null;\n\nexport const startNotificationChecker = (): void => {\n  if (notificationInterval) {\n    clearInterval(notificationInterval);\n  }\n\n  // Check every minute\n  notificationInterval = setInterval(checkNotifications, 60000);\n\n  // Also check immediately\n  checkNotifications();\n};\n\nexport const stopNotificationChecker = (): void => {\n  if (notificationInterval) {\n    clearInterval(notificationInterval);\n    notificationInterval = null;\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}